<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="app.title">Simple Computer Use Desktop - Control Panel</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-container">
        <div class="title-bar">
            <div class="title-bar-drag-region"></div>
            <div class="title-bar-content">
                <div class="title-bar-left">
                    <img src="ic_launcher-playstore.png" alt="Logo" class="title-bar-logo">
                    <span class="title-bar-title" data-i18n="app.title">Simple Computer Use Desktop</span>
                </div>
                <div class="title-bar-controls">
                    <button class="title-bar-button" id="title-bar-minimize" aria-label="" data-i18n="buttons.minimize" data-i18n-attr="aria-label">
                        <span>‚àí</span>
                    </button>
                    <button class="title-bar-button" id="title-bar-maximize" aria-label="" data-i18n="buttons.maximize" data-i18n-attr="aria-label">
                        <span>‚ñ°</span>
                    </button>
                    <button class="title-bar-button title-bar-close" id="title-bar-close" aria-label="" data-i18n="buttons.close" data-i18n-attr="aria-label">
                        <span>√ó</span>
                    </button>
                </div>
            </div>
        </div>
        <header class="header">
            <div class="header-content">
                <div class="header-left">
                    <img src="ic_launcher-playstore.png" alt="Logo" class="app-logo">
                    <h1 class="app-title" data-i18n="app.title">Simple Computer Use Desktop</h1>
                </div>
                <div class="status-container">
                    <span class="status-label" data-i18n="status.label">Status:</span>
                    <span id="status-indicator" class="status-indicator status-stopped" data-i18n="status.stopped">Stopped</span>
                    <button id="theme-toggle" class="btn btn-secondary" style="padding: 8px 12px; min-width: auto;" aria-label="Toggle dark mode">
                        <span id="theme-icon">üåô</span>
                    </button>
                    <div class="language-selector-container">
                        <select id="language-selector" class="language-selector" aria-label="" data-i18n="language.selector" data-i18n-attr="aria-label">
                            <option value="en" data-i18n="language.english">English</option>
                            <option value="es" data-i18n="language.spanish">Espa√±ol</option>
                        </select>
                    </div>
                </div>
            </div>
        </header>
        
        <!-- Ollama Pull Progress Modal -->
        <div id="ollama-pull-modal" class="ollama-pull-modal" style="display: none;">
            <div class="ollama-pull-content">
                <div class="ollama-pull-header">
                    <h2 data-i18n="ollama.downloading">ü¶ô Downloading Ollama Model</h2>
                </div>
                <div class="ollama-pull-body">
                    <div class="ollama-pull-model-name" id="ollama-pull-model-name">gemma3:12b</div>
                    <div class="ollama-pull-status" id="ollama-pull-status" data-i18n="ollama.starting">Starting download...</div>
                    <div class="ollama-pull-progress-container">
                        <div class="ollama-pull-progress-bar">
                            <div class="ollama-pull-progress-fill" id="ollama-pull-progress-fill" style="width: 0%"></div>
                        </div>
                        <div class="ollama-pull-progress-text" id="ollama-pull-progress-text">0%</div>
                    </div>
                    <div class="ollama-pull-message" id="ollama-pull-message"></div>
                </div>
            </div>
        </div>
        
        <main class="main-content">
            <div class="control-buttons">
                <button id="start-btn" class="btn btn-success" data-i18n="buttons.startServer">‚ñ∂ Start Server</button>
                <button id="stop-btn" class="btn btn-danger" disabled data-i18n="buttons.stopServer">‚èπ Stop Server</button>
            </div>
            <div class="tabs">
                <button class="tab-btn active" data-tab="control" data-i18n="tabs.control">Control</button>
                <button class="tab-btn" data-tab="config" data-i18n="tabs.config">Configuration</button>
                <button class="tab-btn" data-tab="logs" data-i18n="tabs.logs">Logs</button>
                <button class="tab-btn" data-tab="history" data-i18n="tabs.history">History</button>
                <button class="tab-btn" data-tab="system-info" data-i18n="tabs.systemInfo">System Info</button>
            </div>
            <div class="tab-content">
                <div id="control-tab" class="tab-pane active">
                    <div class="card">
                        <h2 data-i18n="control.title">Server Control Panel</h2>
                        <p data-i18n="control.welcome">Welcome to the voice server control panel. Use the buttons above to start or stop the server.</p>
                        <div class="quick-guide">
                            <h3 data-i18n="control.quickGuide">üìã Quick Guide</h3>
                            <ol>
                                <li>
                                    <strong data-i18n="control.guideStep1">‚öôÔ∏è Configuration</strong>
                                    <span data-i18n="control.guideStep1Desc">Configure the server in the Configuration tab before starting it.</span>
                                </li>
                                <li>
                                    <strong data-i18n="control.guideStep2">‚ñ∂Ô∏è Start Server</strong>
                                    <span data-i18n="control.guideStep2Desc">Click 'Start Server' to start the voice server.</span>
                                </li>
                                <li>
                                    <strong data-i18n="control.guideStep3">üìä Monitoring</strong>
                                    <span data-i18n="control.guideStep3Desc">Monitor logs in real-time in the Logs tab.</span>
                                </li>
                                <li>
                                    <strong data-i18n="control.guideStep4">üìú History</strong>
                                    <span data-i18n="control.guideStep4Desc">Review the command history in the History tab.</span>
                                </li>
                            </ol>
                        </div>
                    </div>
                </div>
                <div id="config-tab" class="tab-pane">
                    <div class="card">
                        <h2 data-i18n="config.title">Server Configuration</h2>
                        <form id="config-form">
                            <!-- Most Frequently Changed: Models -->
                            <div class="config-section">
                                <div class="config-section-header" onclick="toggleConfigSection(this)">
                                    <h3 data-i18n="config.models">ü§ñ Models</h3>
                                    <span class="collapse-icon">‚ñº</span>
                                </div>
                                <div class="config-section-content">
                                    <p class="section-description" data-i18n="config.modelsDesc">Configure the AI models used for voice recognition and natural language processing.</p>
                                <div class="form-group">
                                    <label data-i18n="config.whisperModel">Whisper Model</label>
                                    <select id="whisper-model">
                                        <option value="tiny" data-i18n="config.whisperModelTiny">Tiny (39 MB) - Fastest, less accurate</option>
                                        <option value="base" data-i18n="config.whisperModelBase">Base (74 MB) - Speed/accuracy balance</option>
                                        <option value="small" data-i18n="config.whisperModelSmall">Small (244 MB) - Good balance</option>
                                        <option value="medium" data-i18n="config.whisperModelMedium">Medium (769 MB) - More accurate</option>
                                        <option value="large" selected data-i18n="config.whisperModelLarge">Large (1550 MB) - Maximum accuracy</option>
                                    </select>
                                    <p class="help-text" data-i18n="config.whisperModelHelp">Voice recognition model. Larger size = higher accuracy but more memory usage.</p>
                                </div>
                                <div class="form-group-row">
                                    <div class="form-group">
                                        <label data-i18n="config.ollamaModel">Ollama Model</label>
                                        <input type="text" id="ollama-model" value="gemma3:12b" data-i18n-placeholder="config.ollamaModelPlaceholder">
                                        <p class="help-text" data-i18n="config.ollamaModelHelp">LLM model for processing commands</p>
                                    </div>
                                    <div class="form-group">
                                        <label data-i18n="config.ollamaHost">Ollama Host</label>
                                        <input type="text" id="ollama-host" value="http://localhost:11434" data-i18n-placeholder="config.ollamaHostPlaceholder">
                                        <p class="help-text" data-i18n="config.ollamaHostHelp">Ollama server URL</p>
                                    </div>
                                </div>
                                </div>
                            </div>
                            
                            <!-- Frequently Changed: Language -->
                            <div class="config-section">
                                <div class="config-section-header" onclick="toggleConfigSection(this)">
                                    <h3 data-i18n="config.language">üåç Language & Translation</h3>
                                    <span class="collapse-icon">‚ñº</span>
                                </div>
                                <div class="config-section-content">
                                    <p class="section-description" data-i18n="config.languageDesc">Configure the default language for voice recognition and automatic translation.</p>
                                <div class="form-group">
                                    <label data-i18n="config.defaultLanguage">Default Language</label>
                                    <input type="text" id="language" value="es" data-i18n-placeholder="config.defaultLanguagePlaceholder">
                                    <p class="help-text" data-i18n="config.defaultLanguageHelp">ISO 639-1 language code (e.g., es, en, fr, de, it, pt)</p>
                                </div>
                                <div class="form-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="translation-enabled">
                                        <span data-i18n="config.translationEnabled">Enable automatic translation of non-English languages</span>
                                    </label>
                                    <p class="help-text" data-i18n="config.translationEnabledHelp">Automatically translate commands in languages other than English before processing them</p>
                                </div>
                                </div>
                            </div>
                            
                            <!-- Moderately Changed: Screenshots -->
                            <div class="config-section">
                                <div class="config-section-header" onclick="toggleConfigSection(this)">
                                    <h3 data-i18n="config.screenshots">üì∏ Screenshots</h3>
                                    <span class="collapse-icon">‚ñº</span>
                                </div>
                                <div class="config-section-content">
                                    <p class="section-description" data-i18n="config.screenshotsDesc">Configure automatic screenshot capture after executing commands.</p>
                                <div class="form-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="screenshots-enabled">
                                        <span data-i18n="config.screenshotsEnabled">Enable screenshots after command execution</span>
                                    </label>
                                    <p class="help-text" data-i18n="config.screenshotsEnabledHelp">Automatic screenshot capture after each executed command</p>
                                </div>
                                <div class="form-group">
                                    <label data-i18n="config.screenshotDir">Screenshot Directory</label>
                                    <div class="input-with-button">
                                        <input type="text" id="screenshot-dir" data-i18n-placeholder="config.screenshotDirPlaceholder">
                                        <button type="button" class="btn btn-secondary" onclick="browseDirectory('screenshot-dir')" data-i18n="buttons.browse">Browse</button>
                                    </div>
                                    <p class="help-text" data-i18n="config.screenshotDirHelp">Directory where screenshots will be saved</p>
                                </div>
                                </div>
                            </div>
                            
                            <!-- Less Frequently Changed: Network -->
                            <div class="config-section">
                                <div class="config-section-header" onclick="toggleConfigSection(this)">
                                    <h3 data-i18n="config.network">üåê Network</h3>
                                    <span class="collapse-icon">‚ñº</span>
                                </div>
                                <div class="config-section-content">
                                    <p class="section-description" data-i18n="config.networkDesc">Configure the address and port where the server will listen for connections.</p>
                                <div class="form-group-row">
                                    <div class="form-group">
                                        <label data-i18n="config.host">Host</label>
                                        <input type="text" id="host" value="0.0.0.0" data-i18n-placeholder="config.hostPlaceholder">
                                        <p class="help-text" data-i18n="config.hostHelp">0.0.0.0 to listen on all interfaces</p>
                                    </div>
                                    <div class="form-group">
                                        <label data-i18n="config.port">Port</label>
                                        <input type="number" id="port" value="5000" min="1" max="65535" data-i18n-placeholder="config.portPlaceholder">
                                        <p class="help-text" data-i18n="config.portHelp">TCP port (1-65535)</p>
                                    </div>
                                </div>
                                </div>
                            </div>
                            
                            <!-- Rarely Changed: SSL/TLS -->
                            <div class="config-section">
                                <div class="config-section-header" onclick="toggleConfigSection(this)">
                                    <h3 data-i18n="config.ssl">üîí SSL/TLS</h3>
                                    <span class="collapse-icon">‚ñº</span>
                                </div>
                                <div class="config-section-content">
                                    <p class="section-description" data-i18n="config.sslDesc">Enable HTTPS for secure connections. Leave fields empty to use self-signed certificate.</p>
                                <div class="form-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="ssl">
                                        <span data-i18n="config.sslEnabled">Enable SSL (HTTPS)</span>
                                    </label>
                                </div>
                                <div class="form-group">
                                    <label data-i18n="config.sslCert">SSL Certificate File</label>
                                    <div class="input-with-button">
                                        <input type="text" id="ssl-cert" data-i18n-placeholder="config.sslCertPlaceholder">
                                        <button type="button" class="btn btn-secondary" onclick="browseSSLFile('cert')" data-i18n="buttons.browse">Browse</button>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label data-i18n="config.sslKey">SSL Private Key File</label>
                                    <div class="input-with-button">
                                        <input type="text" id="ssl-key" data-i18n-placeholder="config.sslKeyPlaceholder">
                                        <button type="button" class="btn btn-secondary" onclick="browseSSLFile('key')" data-i18n="buttons.browse">Browse</button>
                                    </div>
                                </div>
                                <p class="help-text" data-i18n="config.sslHelp">Leave fields empty to use self-signed certificate (useful for local development)</p>
                                </div>
                            </div>
                            
                            <!-- Rarely Changed: Advanced Settings -->
                            <div class="config-section">
                                <div class="config-section-header" onclick="toggleConfigSection(this)">
                                    <h3 data-i18n="config.advanced">‚öôÔ∏è Advanced Settings</h3>
                                    <span class="collapse-icon">‚ñº</span>
                                </div>
                                <div class="config-section-content">
                                    <p class="section-description" data-i18n="config.advancedDesc">Advanced settings for development and security.</p>
                                <div class="form-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="debug">
                                        <span data-i18n="config.debugEnabled">Enable debug mode</span>
                                    </label>
                                    <p class="help-text" data-i18n="config.debugHelp">Show detailed debugging information in logs</p>
                                </div>
                                <div class="form-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="failsafe-enabled">
                                        <span data-i18n="config.failsafeEnabled">Enable PyAutoGUI failsafe</span>
                                    </label>
                                    <p class="help-text" data-i18n="config.failsafeHelp">Move mouse to top-left corner to abort automatic operations</p>
                                </div>
                                </div>
                            </div>
                            
                            <!-- Rarely Changed: Service Settings -->
                            <div class="config-section">
                                <div class="config-section-header" onclick="toggleConfigSection(this)">
                                    <h3 data-i18n="config.service">üöÄ Service Settings</h3>
                                    <span class="collapse-icon">‚ñº</span>
                                </div>
                                <div class="config-section-content">
                                    <p class="section-description" data-i18n="config.serviceDesc">Configure automatic application startup on system boot.</p>
                                <div class="form-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="start-on-boot">
                                        <span data-i18n="config.startOnBoot">Start GUI on system startup (runs as service in system tray)</span>
                                    </label>
                                    <p class="help-text" data-i18n="config.startOnBootHelp">Application will start automatically on login and run minimized in system tray</p>
                                </div>
                                </div>
                            </div>
                            
                            <!-- Rarely Changed: Desktop Application -->
                            <div class="config-section">
                                <div class="config-section-header" onclick="toggleConfigSection(this)">
                                    <h3 data-i18n="config.desktop">üì± Desktop Application</h3>
                                    <span class="collapse-icon">‚ñº</span>
                                </div>
                                <div class="config-section-content">
                                    <p class="section-description" data-i18n="config.desktopDesc">Install the application in the Linux applications menu for quick access.</p>
                                <div class="form-group">
                                    <button type="button" class="btn btn-secondary" onclick="installDesktopApp()" id="install-desktop-btn" data-i18n="buttons.installDesktop">
                                        üì• Install to Applications Menu
                                    </button>
                                    <div id="install-desktop-status" class="help-text" style="margin-top: var(--space-3);"></div>
                                </div>
                                </div>
                            </div>
                            <div class="form-actions">
                                <button type="button" class="btn btn-primary" onclick="saveConfig()" data-i18n="buttons.save">üíæ Save</button>
                            </div>
                        </form>
                    </div>
                </div>
                <div id="logs-tab" class="tab-pane">
                    <div class="card">
                        <div class="logs-header">
                            <h2 data-i18n="logs.title">Server Logs</h2>
                            <button class="btn btn-secondary" onclick="clearLogs()" data-i18n="buttons.clear">üóë Clear</button>
                        </div>
                        <div id="logs-container" class="logs-container">
                            <div class="log-entry info" data-i18n="logs.waiting">Waiting for server to start...</div>
                        </div>
                    </div>
                </div>
                <div id="history-tab" class="tab-pane">
                    <div class="card">
                        <div class="history-header">
                            <h2 data-i18n="history.title">Command History</h2>
                            <button class="btn btn-secondary" onclick="loadHistory()" data-i18n="buttons.reload">üîÑ Reload</button>
                        </div>
                        <div id="history-container">
                            <div class="history-empty-state">
                                <div class="history-empty-state-icon">üìú</div>
                                <h3 data-i18n="history.noHistory">No History Available</h3>
                                <p data-i18n="history.noHistoryDesc">Start the server to view command history.</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="system-info-tab" class="tab-pane">
                    <div class="card">
                        <div class="history-header">
                            <h2 data-i18n="systemInfo.title">System Information</h2>
                            <button class="btn btn-secondary" onclick="refreshSystemInfo()" data-i18n="buttons.refresh">üîÑ Refresh</button>
                        </div>
                        <div id="system-info-container">
                            <div class="history-empty-state">
                                <div class="history-empty-state-icon">‚ÑπÔ∏è</div>
                                <h3 data-i18n="systemInfo.notAvailable">No System Information Available</h3>
                                <p data-i18n="systemInfo.notAvailableDesc">Start the server to view system information.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
        <footer class="app-footer">
            <div class="footer-content">
                <button id="voice-command-btn" class="voice-btn" aria-label="" data-i18n="buttons.holdToSpeak" data-i18n-attr="aria-label">
                    <svg class="voice-btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path>
                        <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
                        <line x1="12" y1="19" x2="12" y2="23"></line>
                        <line x1="8" y1="23" x2="16" y2="23"></line>
                    </svg>
                    <span class="voice-btn-label" data-i18n="buttons.holdToSpeak">Hold to Speak</span>
                </button>
                <div id="voice-status" class="voice-status"></div>
            </div>
        </footer>
    </div>
    <script src="i18n.js"></script>
    <script src="app.js"></script>
</body>
</html>
